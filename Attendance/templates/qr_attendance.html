{% extends "base.html" %}

{% block title %}QR Code Attendance - Nipe Attendance{% endblock %}

{% block content %}
<div class="w-full h-full">

    <div class="glass-panel rounded-2xl p-4 md:p-8 shadow-2xl relative overflow-hidden h-full">
        <!-- Decorative background elements -->
        <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"></div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center h-full">
            <!-- Left Column: QR Code -->
            <div class="flex justify-center order-2 lg:order-1 w-full h-full items-center">
                <div id="qrcode-container"
                    class="bg-white p-4 rounded-xl shadow-inner transition-all duration-500 transform scale-100 w-full aspect-square max-h-[80vh] flex items-center justify-center">
                    <div id="qrcode" class="opacity-50 w-full h-full flex items-center justify-center">
                        <!-- Empty initially, no dummy icon -->
                    </div>
                </div>
            </div>

            <!-- Right Column: Controls -->
            <div id="qr-content-container"
                class="space-y-8 text-center lg:text-left order-1 lg:order-2 flex flex-col justify-center">
                <div>
                    <h1 class="text-4xl font-bold mb-2">QR Code <span class="gradient-text">Attendance</span></h1>
                    <p class="text-slate-400 mb-8">Generate a dynamic QR code for students to scan.</p>

                    <h2 class="text-2xl font-bold text-white mb-2">Session Controls</h2>
                    <p id="meta" class="text-lg text-slate-300 font-medium">Click "Start Session" to begin generating
                        codes.</p>
                </div>

                <div class="flex flex-col sm:flex-row gap-4 justify-center md:justify-start">
                    <button id="start-btn"
                        class="px-8 py-3 rounded-full bg-indigo-600 hover:bg-indigo-500 text-white font-semibold transition-all shadow-lg shadow-indigo-500/25 hover:shadow-indigo-500/40 hover:-translate-y-0.5">
                        <i class="fas fa-play mr-2"></i> Start Session
                    </button>

                    <a href="/attendance"
                        class="px-6 py-3 rounded-full bg-slate-700 hover:bg-slate-600 text-white font-medium transition-all border border-slate-600 hover:border-slate-500 text-center">
                        View Attendance
                    </a>

                    <a href="/download_report"
                        class="px-6 py-3 rounded-full bg-slate-700 hover:bg-slate-600 text-white font-medium transition-all border border-slate-600 hover:border-slate-500 text-center">
                        <i class="fas fa-download mr-2"></i> Export
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/qrcode-generator/qrcode.js"></script>
<script src="/static/js/qrcode.min.js"></script>
<script src="/static/js/script.js"></script>
<script>
    // Simple script to enhance the UI state when starting
    const startBtn = document.getElementById('start-btn');
    const qrContainer = document.getElementById('qrcode-container');
    const qrCode = document.getElementById('qrcode');

    startBtn.addEventListener('click', () => {
        qrCode.classList.remove('opacity-50');
        qrContainer.classList.add('ring-4', 'ring-indigo-500/30');
    });
</script>
{% endblock %}