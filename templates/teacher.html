{% extends "base.html" %}
{% block body %}
<div class="text-center mb-4">
  <h1>Nitte Institute of Professional Education</h1>
  <h5>Attendance Portal - Teacher</h5>
</div>

<div class="card p-3">
  <div class="row g-2">
    <div class="col-md-6">
      <label class="form-label">Session duration (seconds)</label>
      <input id="duration" class="form-control" value="30">
    </div>
    <div class="col-md-6">
      <label class="form-label">Token lifetime (seconds)</label>
      <input id="lifetime" class="form-control" value="2">
    </div>
  </div>
  <div class="mt-3 text-center">
    <button id="startBtn" class="btn btn-primary">Start Session</button>
    <div id="out" class="mt-3"></div>
  </div>
</div>

<script>
document.getElementById('startBtn').onclick = async () => {
  const duration = document.getElementById('duration').value;
  const lifetime = document.getElementById('lifetime').value;
  const res = await fetch('/teacher/start', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({duration, lifetime})
  });
  const j = await res.json();
  if (j.session_id) {
    document.getElementById('out').innerHTML =
      `<p>Session started. <a href="/teacher/session/${j.session_id}" target="_blank">Open session</a></p>
       <p>Student page: <code>/student</code></p>`;
  } else {
    document.getElementById('out').innerText = 'Failed to start';
  }
};
</script>
{% endblock %}
